@(myPurchases: List[models.Transaction])
@import helper.twitterBootstrap._
@import java.util.Calendar

@js = {
  <script>
    function rating() {
      var ratingList=document.getElementById("ratingList");
      document.getElementById("rating").value=ratingList.options[ratingList.selectedIndex].text;
    }
  </script>
}

@views.html.user.main("Storage Exchange", "My Purchases") {
 <div class="post">
    <div class="container">
      @myPurchases.map { purchase =>
        @if(!purchase.canceled) {
          <div class="row well"  data-id="@purchase.transactionID">
            <div class="col-md-2">
              <b>Storage Size</b><br>
              <span class="description">@purchase.storageTaken</span> sq/ft
            </div>
            <div class="col-md-2">
              <b>Start Date: </b><span class="area">@purchase.startDate.toString.substring(0,10)</span>
              <b>End Date: </b><span class="area">@purchase.endDate.toString.substring(0,10)</span>
            </div>
            <div class="col-md-4">
              <b>Seller: </b><span class="area">@purchase.sellerEmail</span>
            </div>
            <div class="col-md-2">
              <b>Rating: </b>
              <span class="area">
                <select id="ratingList" onchange="rating()">
                  <option>Rate User</option>
                  @for(rating <- 1 until 11) {
                    <option>@rating</option>
                  }
                </select>
                <form method="POST" action="@controllers.routes.TransactionLedger.receiveNewRating(purchase.transactionID.get)">
                  <input type="hidden" name="raterEmail" value="@purchase.buyerEmail" />
                  <input type="hidden" name="rateeEmail" value="@purchase.sellerEmail" />
                  <input type="hidden" name="score" value="3" />
                  <input type="submit" value="Rate" />
                </form>
              </span>
            </div>
            <div class="col-md-2">
              @if(!purchase.approved) {
                <b>Approval Pending...</b>
              }
              <a href="@controllers.routes.TransactionLedger.cancelTransactionAsBuyer(purchase.transactionID.get)" style="text-decoration:none">
                <button type="submit" class="btn btn-block">Cancel</button>
              </a>
            </div>  
          </div>
        }
      }
      @if(myPurchases.isEmpty) {
        <h3>You have made no purchases</h3>
      }
    </div>
  </div>
}
